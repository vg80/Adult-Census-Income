
--
title: "Untitled"
author: "vidhu"
date: "June 15, 2018"
output: html_document
---
```{r}
predictorset
```
```{r}
colnames(Adult_dummy_del)[colnames(Adult_dummy_del)=="income..50K"] = "income"

```
# kNN Model
```{r}
set.seed(400)
ctrl = trainControl(method = "cv", 
                     number = 10, 
                     sampling = "smote",
                     summaryFunction= twoClassSummary, 
                     classProbs=T,
                     savePredictions = T)
grid = expand.grid(k=seq(51,61,2))
kNNFit = train(Adult_dummy_del[,predictorset], Adult_dummy_del[,"income"], method = "knn", trControl = ctrl, metric = "ROC", tuneGrid = grid)
```

```{r}
plot(knnFit)
varImp(knnFit)
plot(varImp(knnFit), main = "variable importance knn")
```

# Random Forest
```{r}
ctrl = trainControl(method = "cv", 
                     number = 10, 
                     sampling = "smote",
                     summaryFunction= twoClassSummary, 
                     classProbs=T,
                     savePredictions = T)
levels(Adult_dummy_del$income) =      make.names(levels(factor(Adult_dummy_del$income)))
rfFit = train(Adult_dummy_del[,predictorset], Adult_dummy_del[,"income"], method = "rf", trControl = ctrl, metric = "ROC", tuneLength = 5)

```


```{r}
# Final model 
rfFit
plot(rfFit)
#look at the variable importance and ploting
varImp(rfFit)
plot(varImp(rfFit), main = "variable importance knn")
#predictions
predictions = predict.train(object=rfFit,Adult_dummy_del[,c(predictorset, "income")],type="raw")
#Confusion Matrix
confusionMatrix(predictions,Adult_dummy_del[,"income"])
# Plotting ROC
library(pROC)
roc2 = roc(response = as.numeric(Adult_dummy_del$income), predictor = as.numeric(predict(rfFit)))
plot(roc2)

```
```{r}

nbFit = train(Adult_dummy_del[,predictorset], Adult_dummy_del[,"income"], method = "nb", trControl = ctrl, metric = "ROC", tuneLength = 10)

```


```{r}

gbmFit = train(Adult_dummy_del[,predictorset], Adult_dummy_del[,"income"], method = "gbm", trControl = ctrl, metric = "ROC", tuneLength = 10)

```