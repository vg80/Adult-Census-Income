
--
title: "Untitled"
author: "vidhu"
date: "June 15, 2018"
output: html_document
---
```{r}
predictorset
```
```{r}
colnames(Adult_dummy_del)[colnames(Adult_dummy_del)=="income..50K"] = "income"

```

```{r}
set.seed(400)
ctrl = trainControl(method = "cv", 
                     number = 10, 
                     sampling = "smote",
                     summaryFunction= twoClassSummary, 
                     classProbs=T,
                     savePredictions = T)

kNNFit = train(Adult_dummy_del[,predictorset], Adult_dummy_del[,"income"], method = "knn", trControl = ctrl, metric = "ROC", tuneLength = 10)
```

```{r}
plot(knnFit)
varImp(knnFit)
plot(varImp(knnFit), main = "variable importance knn")
```


```{r}
ctrl = trainControl(method = "cv", 
                     number = 10, 
                     sampling = "smote",
                     summaryFunction= twoClassSummary, 
                     classProbs=T,
                     savePredictions = T)
levels(Adult_dummy_del$income) =      make.names(levels(factor(Adult_dummy_del$income)))
rfFit = train(Adult_dummy_del[,predictorset], Adult_dummy_del[,"income"], method = "rf", trControl = ctrl, metric = "ROC", tuneLength = 5)

```


```{r}
# Final model 
rfFit
plot(rfFit)
#look at the variable importance and ploting
varImp(rfFit)
plot(varImp(rfFit), main = "variable importance knn")
#Confusion Matrix
confusionMatrix(rfFit, norm = "none")
# Plotting ROC
library(pROC)
# select a parameter setting
selectedindices = rfFit$pred$mtry == 2
# Plot:
plot.roc(as.numeric(rfFit$pred$obs[selectedindices]),
         as.numeric(rfFit$pred$pred[selectedindices]))
auc(as.numeric(rfFit$pred$obs[selectedindices]),
         as.numeric(rfFit$pred$pred[selectedindices]))
```
