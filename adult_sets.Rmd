---
title: "R Notebook"
output: html_notebook
---
Missing Value Treatment
I will take two approaches to deal with missing values and compare the results of the models.
1) Deleting missing values
2) Imputing missing values with kNN.( it is time taking process but it should be not bad with this small dataset)

```{r}
Adult= adult
Adult$capitalgain = NULL
Adult$capitalloss = NULL
Adult$fnlwgt = NULL
Adult$hoursperweek = NULL

```

# imputing by kNN
library(VIM)
Sys.time()
adult_imputed = kNN(adult, variable = c("workclass", "occupation", "nativecountry"),k=10, dist_var = c("age", "education", "maritalstatus", "relationship", "race", "sex", "capitalloss_cat", "capitalgain_cat", "hoursperweek_cat", "income"))
Sys.time() 

#```


#Native country bins

#```{r}
# Hong is taken as hongkong, South could be south africa or south korea or south sudan, so keeping those as South only.
adult_delmissing <- mutate(adult_delmissing, 
       nativecountry_bin = ifelse(nativecountry %in% c("Cambodia", "China", "Hong", "Laos", "Philippines", "Thailand", "Japan", "Taiwan", "Vietnam") , "East-Asia",
                ifelse(nativecountry %in% c("India", "Iran"), "West-Asia",
                ifelse(nativecountry %in% c("Cuba", "Guatemala", "Jamaica", "Nicaragua", "Puerto-Rico",  "Dominican-Republic", "El-Salvador", "Haiti", "Honduras", "Mexico", "Trinadad&Tobago"), "Central-America",
                ifelse(nativecountry %in% c("Ecuador", "Peru", "Columbia"), "South-America",
                ifelse(nativecountry %in% c("England", "Germany", "Holand-Netherlands", "Ireland", "France", "Greece", "Italy", "Portugal", "Scotland"), "Europe-West",
                ifelse(nativecountry %in% c("Poland", "Yugoslavia", "Hungary"), "Europe-East",
                ifelse(nativecountry %in% c("United-States","Canada"), "North-America", 
                 ifelse(nativecountry %in% c("Outlying-US(Guam-USVI-etc)"),       "US-Territories", "South" )))))))))
adult_delmissing$nativecountry_bin = as.factor(adult_delmissing$nativecountry_bin)
#```


```{r}
library(dummy)
Adult_dummy = dummy(Adult, int = TRUE)

Adult_dummy = cbind(Adult_dummy, Adult$age)
Adult_dummy_del = Adult_dummy[which(complete.cases(Adult_dummy)==TRUE),]
```


#```{r}
write.csv(adult_imputed, file= "adult_imputed.csv", quote = FALSE, row.names = FALSE)
write.csv(adult_dummy, file= "adult_dummy.csv", quote = FALSE, row.names = FALSE)

list.files()
#```
