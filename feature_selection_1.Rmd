---
title: "R Notebook"
output: html_notebook
---
```{r}

library(FSelector)
```



```{r}

N= nearZeroVar(Adult_dummy_del[,-which(names(Adult_dummy_del)=="income..50K")], saveMetrics = TRUE)
# lets find information gain of attributes
M = information.gain(income..50K~., Adult_dummy_del)
#checking 
rownames(N)==rownames(M)
Z = cbind(N,M)
Z1 = Z[which( Z$attr_importance == 0),] 
name = names(Adult_dummy_del)[!names(Adult_dummy_del) %in% rownames(Z1)]
dummy_del = Adult_dummy_del[,name]

```

Adult_dummy_del = Adult_dummy_del[,-N]
dim(Adult_dummy_del)
colnames(Adult_dummy_del)


```{r}
# calculate correlation matrix
correlationMatrix = cor(dummy_del[,-which(names(dummy_del)=="income..50K")])
# summarize the correlation matrix
print(correlationMatrix)
# find attributes that are highly corrected (ideally >0.75)
highlyCorrelated = findCorrelation(correlationMatrix, cutoff=0.8)
# print indexes of highly correlated attributes
print(highlyCorrelated)
colnames(dummy_del[,highlyCorrelated])
```
```{r}

colnames(dummy_del)[colnames(dummy_del)=="income..50K"] = "income"

```

```{r}
set.seed(7)
Set =Adult_dummy_del

# define the control using a random forest selection function
control <- rfeControl(functions=rfFuncs, method="cv", number=5)
# run the RFE algorithm
results <- rfe(Set[,c(1:43,45:53)], Set[,44], sizes=c(1:43,45:53), rfeControl=control)
# summarize the results
print(results)
# list the chosen features
predictors(results)
# plot the results
plot(results, type=c("g", "o"))

```


```{r}
library(caret)
Data = Adult_dummy
train.index <- createDataPartition(Data$income, p = .75, list = FALSE)
train = Data[ train.index,]
test  = Data[-train.index,]
train_del = train[which(complete.cases(train)==TRUE),]
test_del = test[which(complete.cases(test)==TRUE),]
```

Descision Tree
```{r}
library(rpart)
x <- cbind(train,y_train)
# grow tree 
fit <- rpart(y_train ~ ., data = x,method="class")
summary(fit)
#Predict Output 
predicted= predict(fit,x_test)
trctrl <- trainControl(method = "repeatedcv", number = 10, repeats = 3)
set.seed(3333)
dtree_fit <- train(V7 ~., data = training, method = "rpart",
                   parms = list(split = "information"),
                   trControl=trctrl,
                   tuneLength = 10)

```