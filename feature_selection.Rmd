---
title: "Untitled"
author: "vidhu"
date: "June 14, 2018"
output: html_document
---

```{r}
Adult= adult
Adult$capitalgain = NULL
Adult$capitalloss = NULL
Adult$fnlwgt = NULL
Adult$hoursperweek = NULL

```


```{r}
library(dummy)
Adult_dummy = dummy(Adult, int = TRUE)

Adult_dummy = cbind(Adult_dummy, Adult$age)
Adult_dummy_del = Adult_dummy[which(complete.cases(Adult_dummy)==TRUE),]
Adult_dummy_del$workclass_Never.worked = NULL
```

```{r}
# calculate correlation matrix
correlationMatrix = cor(Adult_dummy_del)
# summarize the correlation matrix
print(correlationMatrix)
# find attributes that are highly corrected (ideally >0.75)
highlyCorrelated = findCorrelation(correlationMatrix, cutoff=0.8)
# print indexes of highly correlated attributes
print(highlyCorrelated)
colnames(Adult_dummy_del[,highlyCorrelated])
```

```{r}
Adult_dummy_del =  Adult_dummy_del[,-highlyCorrelated]
colnames(Adult_dummy_del)[colnames(Adult_dummy_del)=="income_.50K"] = "income"
Adult_dummy_del$income = as.factor(Adult_dummy_del$income)
findLinearCombos(Adult_dummy_del)

```


```{r}
Adult_dummy_del$nativecountry_Holand.Netherlands = NULL

control <- trainControl(method="repeatedcv", number=5, repeats=3)
# train the model
model <- train(income~., data=Adult_dummy_del, method="lvq", preProcess="scale", trControl=control)
# estimate variable importance
importance <- varImp(model, scale=FALSE)
# summarize importance
print(importance)
# plot importance
plot(importance)
```